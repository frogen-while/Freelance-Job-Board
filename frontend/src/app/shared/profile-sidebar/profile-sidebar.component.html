<!-- Guest Sidebar - Show CTA for non-logged in users -->
<div class="profile-sidebar guest-sidebar" *ngIf="!loading && !isLoggedIn">
  <div class="guest-content">
    <div class="guest-icon">
      <mat-icon>person</mat-icon>
    </div>
    <h3 class="guest-title">Join Our Platform</h3>
    <p class="guest-text">Create a free account to apply for jobs or post projects.</p>
    <div class="guest-actions">
      <a routerLink="/register" class="btn-gradient btn-sm btn-block">Sign Up Free</a>
      <a routerLink="/login" class="btn-dark-secondary btn-sm btn-block">Log In</a>
    </div>
  </div>
</div>

<!-- Authenticated User Sidebar -->
<div class="profile-sidebar" *ngIf="!loading && isLoggedIn && user">
  <div class="sidebar-header">
    <div class="avatar">
      <img *ngIf="profile?.photo_url" [src]="profile.photo_url" [alt]="getDisplayName()" />
      <span *ngIf="!profile?.photo_url" class="initials">{{ getInitials() }}</span>
    </div>
    <div class="user-info">
      <h3 class="name">{{ getDisplayName() }}</h3>
      <p class="headline" *ngIf="profile?.headline">{{ profile.headline }}</p>
    </div>
  </div>

  <div class="sidebar-body">
    <!-- Freelancer Stats -->
    <ng-container *ngIf="isFreelancer && freelancerStats">
      <!-- Stats Grid -->
      <div class="stats-grid">
        <div class="stat-item" *ngIf="freelancerStats.hourly_rate">
          <span class="stat-value">${{ freelancerStats.hourly_rate }}</span>
          <span class="stat-label">Per Hour</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ freelancerStats.jobs_completed || 0 }}</span>
          <span class="stat-label">Jobs Done</span>
        </div>
        <div class="stat-item" *ngIf="freelancerStats.rating">
          <span class="stat-value">⭐ {{ formatRating(freelancerStats.rating) }}</span>
          <span class="stat-label">{{ freelancerStats.reviews_count }} reviews</span>
        </div>
        <div class="stat-item" *ngIf="freelancerStats.experience_level">
          <span class="stat-value experience">{{ getExperienceLabel() }}</span>
          <span class="stat-label">Experience</span>
        </div>
      </div>
    </ng-container>

    <!-- Employer Stats -->
    <ng-container *ngIf="isEmployer && employerStats">
      <div class="company-info" *ngIf="employerStats.company_name">
        <span class="company-name">{{ employerStats.company_name }}</span>
        <span class="company-industry" *ngIf="employerStats.industry">{{ employerStats.industry }}</span>
      </div>

      <!-- Stats Grid -->
      <div class="stats-grid">
        <div class="stat-item">
          <span class="stat-value">{{ employerStats.jobs_posted || 0 }}</span>
          <span class="stat-label">Jobs Posted</span>
        </div>
        <div class="stat-item" *ngIf="employerStats.total_spent && employerStats.total_spent > 0">
          <span class="stat-value">${{ employerStats.total_spent | number:'1.0-0' }}</span>
          <span class="stat-label">Total Spent</span>
        </div>
        <div class="stat-item" *ngIf="employerStats.rating">
          <span class="stat-value">⭐ {{ formatRating(employerStats.rating) }}</span>
          <span class="stat-label">{{ employerStats.reviews_count }} reviews</span>
        </div>
      </div>
    </ng-container>

    <!-- Location -->
    <div class="info-item" *ngIf="profile?.location">
      <mat-icon>location_on</mat-icon>
      <span>{{ profile.location }}</span>
    </div>

    <!-- Skills (freelancer only) -->
    <div class="skills-section" *ngIf="isFreelancer && profile?.skills?.length">
      <h4>Skills</h4>
      <div class="skills-list">
        <span class="skill-tag-dark" *ngFor="let skill of profile.skills?.slice(0, 5)">{{ skill }}</span>
        <span class="skill-more" *ngIf="profile.skills && profile.skills.length > 5">
          +{{ profile.skills.length - 5 }} more
        </span>
      </div>
    </div>
  </div>

  <div class="sidebar-footer">
    <a routerLink="/profile" class="edit-profile-link">
      <mat-icon>edit</mat-icon>
      Edit Profile
    </a>
  </div>
</div>

<div class="profile-sidebar skeleton" *ngIf="loading">
  <div class="skeleton-avatar"></div>
  <div class="skeleton-line"></div>
  <div class="skeleton-line short"></div>
</div>
