<div class="support-page">
  <div class="support-container">
    <div class="page-header">
      <br><br>
      <h1>Support Center</h1>
      <p>We're here to help you with any questions or issues</p>
    </div>

    <div class="content-grid">
      <div class="left-column" *ngIf="!isAdminRole">
        <div class="submit-section section-card">
          <h2>Submit a Support Ticket</h2>
          <form (ngSubmit)="submitTicket()" class="ticket-form">
            <div class="form-group">
              <label for="subject">Subject *</label>
              <input id="subject" type="text" [(ngModel)]="ticketSubject" name="subject"
                placeholder="Brief description of your issue" required [disabled]="isSubmitting" />
            </div>
            <div class="form-group">
              <label for="message">Message *</label>
              <textarea id="message" [(ngModel)]="ticketMessage" name="message"
                placeholder="Describe your issue in detail" rows="5" required [disabled]="isSubmitting"></textarea>
            </div>
            <button type="submit" class="submit-btn" [disabled]="isSubmitting || !currentUser">
              {{ isSubmitting ? 'Submitting...' : 'Submit Ticket' }}
            </button>
            <div *ngIf="submitSuccess" class="success-message">Ticket submitted successfully!</div>
            <div *ngIf="!currentUser" class="warning-message">Please log in to submit a support ticket.</div>
          </form>
        </div>

        <div class="history-section section-card">
          <h2>Your Support Tickets</h2>
          <div *ngIf="loadingTickets" class="loading">Loading tickets...</div>
          <div *ngIf="!loadingTickets && userTickets.length === 0" class="no-tickets">No support tickets yet.</div>
          <div *ngIf="!loadingTickets && userTickets.length > 0" class="tickets-list">
            <div *ngFor="let ticket of userTickets" class="ticket-item">
              <div class="ticket-header">
                <h3>{{ ticket.subject }}</h3>
                <span class="status-badge" [style.backgroundColor]="getStatusColor(ticket.status)">{{ ticket.status }}</span>
              </div>
              <p class="ticket-message">{{ ticket.message }}</p>
              <div class="ticket-footer">
                <span class="ticket-date">{{ ticket.created_at | date: 'short' }}</span>
                <span class="ticket-id">ID: #{{ ticket.ticket_id }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="left-column" *ngIf="isAdminRole">
        <div class="section-card admin-notice">
          <h2>Admin Access</h2>
          <p>As an admin, you can manage support tickets from the <a routerLink="/admin/tickets">Admin Panel â†’ Tickets</a> section.</p>
        </div>
      </div>

      <div class="faq-section section-card">
        <h2>Frequently Asked Questions</h2>
        <ol class="faq-list">
          <li *ngFor="let faq of faqs" class="faq-item">
            <strong>{{ faq.question }}</strong>
            <p>{{ faq.answer }}</p>
          </li>
        </ol>
      </div>
    </div>
  </div>
</div>
