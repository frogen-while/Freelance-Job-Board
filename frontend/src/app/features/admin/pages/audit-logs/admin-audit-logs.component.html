<div class="admin-audit-logs">
  <header class="page-header">
    <h1 class="page-title">Audit Logs</h1>
    <p class="page-subtitle">Track all system activities and changes</p>
  </header>

  <!-- Error State -->
  <div class="error-message" *ngIf="errorMessage">
    <mat-icon>error_outline</mat-icon>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Filters -->
  <div class="filters-bar">
    <div class="filter-group">
      <select [(ngModel)]="actionFilter" (change)="onFilterChange()">
        <option value="">All Actions</option>
        <option *ngFor="let action of actions" [value]="action">{{ action }}</option>
      </select>
      
      <select [(ngModel)]="entityFilter" (change)="onFilterChange()">
        <option value="">All Entities</option>
        <option *ngFor="let entity of entityTypes" [value]="entity">{{ entity }}</option>
      </select>
      
      <div class="date-filter">
        <label>From:</label>
        <input type="date" [(ngModel)]="dateFrom" (change)="onFilterChange()">
      </div>
      
      <div class="date-filter">
        <label>To:</label>
        <input type="date" [(ngModel)]="dateTo" (change)="onFilterChange()">
      </div>
      
      <button class="btn-outline" (click)="clearFilters()">
        <mat-icon>clear</mat-icon> Clear
      </button>
    </div>
  </div>

  <!-- Logs List -->
  <div class="logs-container" *ngIf="!loading">
    <div class="logs-list" *ngIf="logs.length > 0">
      <div class="log-item" *ngFor="let log of logs">
        <div class="log-icon" [attr.data-color]="getActionColor(log.action)">
          <mat-icon>history</mat-icon>
        </div>
        
        <div class="log-content">
          <div class="log-header">
            <span class="log-action" [attr.data-color]="getActionColor(log.action)">
              {{ log.action }}
            </span>
            <span class="log-entity" *ngIf="log.entity_type">
              {{ log.entity_type }}
              <span *ngIf="log.entity_id">#{{ log.entity_id }}</span>
            </span>
          </div>
          
          <div class="log-user">
            <mat-icon>person</mat-icon>
            {{ log.user_name || log.user_email || 'User #' + log.user_id }}
          </div>
          
          <div class="log-details" *ngIf="log.details">
            {{ formatDetails(log.details) }}
          </div>
          
          <div class="log-meta">
            <span class="log-time">
              <mat-icon>schedule</mat-icon>
              {{ formatDate(log.created_at) }}
            </span>
            <span class="log-ip" *ngIf="log.ip_address">
              <mat-icon>public</mat-icon>
              {{ log.ip_address }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="logs.length === 0">
      <mat-icon>history</mat-icon>
      <p>No audit logs found</p>
      <span>Try adjusting your filters</span>
    </div>

    <div class="load-more" *ngIf="logs.length > 0 && hasMore">
      <button class="btn-outline" (click)="loadMore()">
        Load More
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <span>Loading audit logs...</span>
  </div>
</div>
